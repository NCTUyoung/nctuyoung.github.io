import{x as Ie,f as _,r as S,y as ve,z as Te,e as me,A as fe,c as s,o,a as e,q as B,u as l,t as b,h as M,F as ce,m as ue,B as Le,C as Me,D as pe,E as De,g as je,G as Ne,b as xe,l as $e,H as ze,w as Be}from"./Crl1EE0P.js";import{u as Ce,a as We,b as Ve,c as Ae,d as Fe}from"./CfIbClCo.js";import{u as Oe}from"./cSWf-aUu.js";import{_ as Ye}from"./DlAUqK2U.js";const se=u=>{const g=String(u.getMonth()+1).padStart(2,"0"),n=String(u.getDate()).padStart(2,"0");return`${g}/${n}`},Pe=u=>u>=1?`${u}s`:`1/${Math.round(1/u)}s`,He=(u,g)=>u==="NIKON CORPORATION"?g||"Nikon Camera":`${u} ${g}`.trim(),Ge=u=>{var g;if(u.camera){const n=(g=u.filename.match(/DSC_(\d+)/))==null?void 0:g[1];return n?`攝影 #${n}`:"攝影作品"}return u.title},Re=u=>{if(!u.tags||u.tags.length===0)return null;const g=["後製","夜拍","人像","望遠","廣角","淺景深","標準","日光"];for(const n of g)if(u.tags.includes(n))return n;return u.tags[0]},Ke=u=>{const g=["h-64","h-80","h-48","h-72","h-56"];return g[u%g.length]},Xe=async()=>(await(await fetch("/galleryList.json")).json()).Img.map(n=>({id:`digital-${n.filename}`,filename:n.filename,title:n.title,description:n.content,date:n.time,time:n.time,color:n.color,category:"digital",visible:!0})),Qe=async()=>{const g=await(await fetch("/photographyList.json")).json();return{works:g.Img.map(f=>({id:`photo-${f.filename}`,filename:f.filename,title:f.title,description:f.content,date:f.time,time:f.time,tags:f.tags||[],event:f.event||null,camera:f.camera,model:f.model,focalLength:f.focalLength,aperture:f.aperture,iso:f.iso,shutterSpeed:f.shutterSpeed,category:"photography",visible:!0})),eventStats:g.eventStats||{}}},ge=Ie("gallery",()=>{const{state:u,isLoading:g,error:n,execute:f}=Ce(Xe,[],{immediate:!1,resetOnExecute:!1}),{state:z,isLoading:A,error:E,execute:c}=Ce(Qe,{works:[],eventStats:{}},{immediate:!1,resetOnExecute:!1}),x=_(()=>z.value.works),K=_(()=>z.value.eventStats),q=_(()=>g.value||A.value),I=We("gallery-filters",{selectedCategory:"all",selectedEvent:null,searchQuery:"",yearFilter:null}),T=S({}),p=S(new Map),j=_(()=>{const r=`allWorks-${u.value.length}-${x.value.length}`;if(p.value.has(r))return p.value.get(r);const i=[...u.value.map(y=>({...y,category:"digital"})),...x.value.map(y=>({...y,category:"photography"}))].sort((y,d)=>new Date(d.time).getTime()-new Date(y.time).getTime());return p.value.set(r,i),i}),W=_(()=>{const{selectedCategory:r,selectedEvent:m}=I.value;let i=[];return r==="digital"?i=u.value:r==="photography"?(i=x.value,m&&(i=i.filter(y=>y.event&&y.event.name===m))):i=j.value,i}),X=_(()=>{const{searchQuery:r,yearFilter:m}=I.value;let i=W.value;if(r){const y=r.toLowerCase();i=i.filter(d=>{var C;return d.title.toLowerCase().includes(y)||d.description.toLowerCase().includes(y)||((C=d.tags)==null?void 0:C.some(k=>k.toLowerCase().includes(y)))})}return m&&(i=i.filter(y=>new Date(y.date).getFullYear().toString()===m)),i.sort((y,d)=>new Date(d.date).getTime()-new Date(y.date).getTime())}),U=_(()=>{const r=W.value;if(!r.some(d=>d.event))return[];const i=new Map;return r.forEach(d=>{var N;const C=((N=d.event)==null?void 0:N.name)||null,k=C||"no-event";i.has(k)||i.set(k,{eventName:C,eventInfo:d.event,images:[],timeRange:""}),i.get(k).images.push(d)}),Array.from(i.values()).map(d=>{const C=d.images.map(L=>new Date(L.time)),k=new Date(Math.min(...C)),N=new Date(Math.max(...C));return d.timeRange=k.getTime()===N.getTime()?se(k):`${se(k)} - ${se(N)}`,d.images.sort((L,ee)=>new Date(ee.time).getTime()-new Date(L.time).getTime()),d}).sort((d,C)=>{const k=Math.max(...d.images.map(L=>new Date(L.time).getTime()));return Math.max(...C.images.map(L=>new Date(L.time).getTime()))-k})}),P=_(()=>{const r=`mixedItems-${W.value.length}-${JSON.stringify(I.value)}`;if(p.value.has(r))return p.value.get(r);const m=[],i=new Map;W.value.forEach(d=>{let C="no-event",k=null,N=null;if(d.category==="photography"&&d.event)C=d.event.name,k=d.event.name,N=d.event;else if(d.category==="digital"){const L=new Date(d.time).getFullYear();C=`digital-${L}`,k=`數位作品 ${L}`}else k="攝影作品";i.has(C)||i.set(C,{eventName:k,eventInfo:N,images:[],timeRange:""}),i.get(C).images.push(d)}),i.forEach((d,C)=>{const k=d.images.map(ee=>new Date(ee.time)),N=new Date(Math.min(...k)),L=new Date(Math.max(...k));d.timeRange=N.getTime()===L.getTime()?se(N):`${se(N)} - ${se(L)}`,d.images.sort((ee,ye)=>new Date(ye.time).getTime()-new Date(ee.time).getTime()),m.push({type:"group",key:`group-${C}`,...d})});const y=m.sort((d,C)=>{const k=Math.max(...(d.images||[]).map(L=>new Date(L.time).getTime()));return Math.max(...(C.images||[]).map(L=>new Date(L.time).getTime()))-k});return p.value.set(r,y),y}),le=_(()=>{const r={};return x.value.forEach(m=>{if(m.event&&m.event.name){const i=m.event.name,y=new Date(m.time).getTime();(!r[i]||y>r[i])&&(r[i]=y)}}),Object.entries(K.value).map(([m,i])=>({name:m,count:i,latestTime:r[m]||0})).sort((m,i)=>i.latestTime-m.latestTime).map(({name:m,count:i})=>({name:m,count:i}))}),ae=_(()=>[...new Set(j.value.map(m=>new Date(m.date).getFullYear().toString()))].sort((m,i)=>i.localeCompare(m))),te=_(()=>({all:u.value.length+x.value.length,digital:u.value.length,photography:x.value.length})),H=async()=>{await Promise.all([f(),c()])},Z=Te(r=>{I.value.searchQuery=r,F(["mixedItems","filteredItems"])},300),ne=r=>{I.value.selectedCategory=r,F(["mixedItems"])},J=r=>{I.value.selectedEvent=r,F(["mixedItems"])},Q=r=>{Z(r)},ie=r=>{I.value.yearFilter=r,F(["filteredItems"])},w=()=>{I.value.selectedCategory="all",I.value.selectedEvent=null,I.value.searchQuery="",I.value.yearFilter=null,F()},h=r=>{T.value[r]=!T.value[r]},oe=(r,m)=>{if(!r.event)return!1;const i=r.event.name;for(let y=0;y<m;y++){const d=W.value[y];if(d.event&&d.event.name===i)return!1}return!0},F=r=>{r?r.forEach(m=>{for(const i of p.value.keys())i.includes(m)&&p.value.delete(i)}):p.value.clear()},re=async()=>{F(),await H()};return ve([u,x],()=>{F(["allWorks","mixedItems"])},{deep:!0}),{digitalWorks:u,photographyWorks:x,eventStats:K,expandedGroups:T,isLoading:q,filterState:I,allWorks:j,currentWorks:W,filteredItems:X,groupedWorks:U,mixedPhotoItems:P,availableEvents:le,availableYears:ae,categoryStats:te,loadAllWorks:H,loadDigitalWorks:f,loadPhotographyWorks:c,setSelectedCategory:ne,setSelectedEvent:J,setSearchQuery:Q,setYearFilter:ie,clearFilters:w,toggleGroupExpansion:h,shouldShowEventOnTimeline:oe,refreshData:re,clearCache:F,formatDate:se,formatShutterSpeed:Pe,formatCameraName:He,getDisplayTitle:Ge,getPrimaryTag:Re,getImageClass:Ke,digitalError:n,photographyError:E}}),qe={class:"flex space-x-8 mb-8"},Ue=me({__name:"GalleryTabBar",setup(u){const g=ge(),{filterState:n,categoryStats:f}=fe(g),{setSelectedCategory:z}=g;return(A,E)=>(o(),s("div",qe,[e("button",{onClick:E[0]||(E[0]=c=>l(z)("digital")),class:B([l(n).selectedCategory==="digital"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 數位繪圖 ("+b(l(f).digital)+") ",3),e("button",{onClick:E[1]||(E[1]=c=>l(z)("photography")),class:B([l(n).selectedCategory==="photography"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 攝影作品 ("+b(l(f).photography)+") ",3),e("button",{onClick:E[2]||(E[2]=c=>l(z)("all")),class:B([l(n).selectedCategory==="all"?"border-b-2 border-gray-800 text-gray-800":"text-gray-500 hover:text-gray-700","pb-2 font-light tracking-wide transition-colors duration-200"])}," 全部作品 ("+b(l(f).all)+") ",3)]))}}),Ze={key:0,class:"mb-8"},Je={class:"flex flex-wrap gap-3 mb-4"},et=["onClick"],tt=me({__name:"EventFilter",setup(u){const g=ge(),{filterState:n,availableEvents:f,photographyWorks:z}=fe(g),{setSelectedEvent:A}=g;return ve(()=>n.value.selectedCategory,E=>{E!=="photography"&&n.value.selectedEvent&&A(null)}),(E,c)=>l(n).selectedCategory==="photography"&&l(f).length>0?(o(),s("div",Ze,[e("div",Je,[e("button",{onClick:c[0]||(c[0]=x=>l(A)(null)),class:B([l(n).selectedEvent===null?"bg-gray-800 text-white":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50","px-4 py-2 rounded-lg text-sm font-light transition-colors duration-200"])}," 全部事件 ("+b(l(z).length)+") ",3),(o(!0),s(ce,null,ue(l(f),x=>(o(),s("button",{key:x.name,onClick:K=>l(A)(x.name),class:B([l(n).selectedEvent===x.name?"bg-gray-800 text-white":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50","px-4 py-2 rounded-lg text-sm font-light transition-colors duration-200"])},b(x.name)+" ("+b(x.count)+") ",11,et))),128))])])):M("",!0)}}),ot=["title"],st={class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},at={key:0,"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},nt={key:1,"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"},rt={class:"text-sm text-gray-500 font-light tracking-wide mb-10"},lt={class:"transform md:-rotate-90 origin-center whitespace-nowrap inline-block"},it={key:0,class:"text-gray-700 mb-1 truncate"},dt={key:1,class:"text-gray-500 truncate"},ct=me({__name:"GalleryTimelineItem",props:{index:{},timeLabel:{},eventInfo:{},eventKey:{},showEventControl:{type:Boolean,default:!1},showEventInfo:{type:Boolean,default:!1}},setup(u){const g=u,n=ge(),{expandedGroups:f}=fe(n),{toggleGroupExpansion:z}=n,A=_(()=>{var c;return((c=g.eventInfo)==null?void 0:c.name)||"事件"}),E=_(()=>g.eventKey&&f.value[g.eventKey]||!1);return(c,x)=>(o(),s("div",{class:B(["flex items-start relative",c.index%2===0?"md:flex-row":"md:flex-row-reverse"])},[e("div",{class:B(["md:w-40 flex-shrink-0 text-right md:text-left mb-4 md:mb-0 relative",c.index%2===0?"md:mr-16":"md:ml-16 md:text-right"])},[e("div",{class:B(["absolute w-4 h-4 bg-white border-2 border-gray-400 rounded-full hidden md:block z-10",c.index%2===0?"left-[-4.5rem]":"right-[-4.5rem]"])},null,2),c.showEventControl?(o(),s("div",{key:0,class:B(["absolute hidden md:block z-20",c.index%2===0?"left-[-3.5rem]":"right-[-3.5rem]"])},[e("button",{onClick:x[0]||(x[0]=K=>c.eventKey&&l(z)(c.eventKey)),class:B(["w-5 h-5 rounded-full transition-all duration-200 flex items-center justify-center group shadow-sm",E.value?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"]),title:`${E.value?"折疊":"展開"} ${A.value} 的作品`},[(o(),s("svg",st,[E.value?(o(),s("path",at)):(o(),s("path",nt))]))],10,ot)],2)):M("",!0),e("div",rt,[e("span",lt,b(c.timeLabel),1)]),c.eventInfo&&c.showEventInfo&&(c.eventInfo.description||c.eventInfo.location)?(o(),s("div",{key:1,class:B(["hidden md:block",c.index%2===0?"":"text-right"])},[e("div",{class:B(["p-2 bg-white/90 backdrop-blur-sm rounded text-xs shadow-sm max-w-32",c.index%2===0?"text-left":"text-right"])},[c.eventInfo.description?(o(),s("div",it,b(c.eventInfo.description),1)):M("",!0),c.eventInfo.location?(o(),s("div",dt," 📍 "+b(c.eventInfo.location),1)):M("",!0)],2)],2)):M("",!0)],2),e("div",{class:B(["flex-1 md:max-w-2xl",c.index%2===0?"md:ml-16":"md:mr-16"])},[Le(c.$slots,"default")],2)],2))}}),ut=["src","alt"],vt={key:1,class:"w-full h-full bg-gray-200 animate-pulse flex items-center justify-center"},mt={key:2,class:"w-full h-full bg-red-50 flex items-center justify-center"},gt={key:3,class:"absolute top-4 right-4"},ht={key:0,class:"px-2 py-1 text-xs font-light border border-gray-200 text-gray-600 rounded bg-white/90 backdrop-blur-sm"},pt={key:1,class:"px-3 py-1 rounded-full text-xs font-light bg-white/90 backdrop-blur-sm text-gray-700 shadow-sm border border-gray-100"},ft={key:4,class:"absolute top-4 left-4 md:hidden"},yt={class:"px-2 py-1 rounded text-xs font-light bg-gray-800/80 text-white"},bt={class:"p-6 bg-white/80 backdrop-blur-sm mt-2 rounded-lg border border-gray-100"},xt={class:"flex items-center justify-between mb-4"},wt={class:"text-xl font-light text-gray-800 tracking-wide"},kt=["title"],_t={key:0,class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$t={key:1,class:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ct={key:0},Mt={class:"flex items-center text-sm text-gray-500 mb-4 font-light"},St={class:"grid grid-cols-4 gap-4 text-xs border-t border-gray-100 pt-4"},Et={key:0,class:"text-center"},It={class:"font-medium text-gray-700"},Tt={key:1,class:"text-center"},Lt={class:"font-medium text-gray-700"},Dt={key:2,class:"text-center"},jt={class:"font-medium text-gray-700"},Nt={key:3,class:"text-center"},zt={class:"font-medium text-gray-700"},Bt={key:1,class:"border-t border-gray-100 pt-4"},Wt={class:"text-gray-600 text-sm leading-relaxed font-light"},Vt=me({__name:"PhotoCard",props:{image:{},index:{}},emits:["openViewer"],setup(u,{emit:g}){const n=u,f=g,z=ge(),A=S(),E=S(!1),c=S(!1),x=S(!1);Ve(A,([{isIntersecting:w}])=>{K.value=w},{threshold:.1});const K=S(!1),{x:q,y:I}=Ae({target:A}),{copy:T,copied:p}=Fe(),j=S(0),W=S(0),X=_(()=>z.getDisplayTitle(n.image)),U=_(()=>z.getPrimaryTag(n.image)),P=_(()=>n.image.camera&&n.image.model?z.formatCameraName(n.image.camera,n.image.model):""),le=_(()=>n.image.shutterSpeed?z.formatShutterSpeed(n.image.shutterSpeed):""),ae=_(()=>n.index!==void 0?z.getImageClass(n.index):"h-64"),te=()=>{E.value=!0,c.value=!1},H=()=>{c.value=!0,E.value=!1},Z=w=>{var oe;x.value=!0;const h=(oe=A.value)==null?void 0:oe.getBoundingClientRect();if(h){const F=h.left+h.width/2,re=h.top+h.height/2,r=(w.clientY-re)/10,m=(F-w.clientX)/10;j.value=Math.max(-10,Math.min(10,r)),W.value=Math.max(-10,Math.min(10,m))}},ne=()=>{x.value=!1,j.value=0,W.value=0},J=Me(),Q=async w=>{w.stopPropagation();try{const h=`${window.location.origin}/images/${n.image.filename}`;await T(h),J.success("連結已複製！","圖片連結已複製到剪貼簿")}catch{J.error("複製失敗","無法複製連結到剪貼簿")}},ie=()=>{f("openViewer",n.image)};return(w,h)=>(o(),s("div",{ref_key:"cardRef",ref:A,class:"group hover:transform hover:scale-105 transition-all duration-300 cursor-pointer",onMouseenter:Z,onMouseleave:ne,onClick:ie,style:pe({transform:`perspective(1000px) rotateX(${j.value}deg) rotateY(${W.value}deg)`})},[e("div",{class:B(["relative overflow-hidden rounded-lg border border-gray-100",ae.value])},[K.value?(o(),s("img",{key:0,src:`/images/${w.image.filename}`,alt:w.image.title,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onLoad:te,onError:H},null,40,ut)):E.value?c.value?(o(),s("div",mt,h[1]||(h[1]=[e("div",{class:"text-center"},[e("svg",{class:"w-8 h-8 text-red-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("p",{class:"text-xs text-red-600"},"載入失敗")],-1)]))):M("",!0):(o(),s("div",vt,h[0]||(h[0]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z","clip-rule":"evenodd"})],-1)]))),K.value?(o(),s("div",gt,[U.value?(o(),s("span",ht,b(U.value),1)):(o(),s("span",pt,b(w.image.category==="digital"?"繪圖":"攝影"),1))])):M("",!0),w.image.event&&K.value?(o(),s("div",ft,[e("span",yt,b(w.image.event.name),1)])):M("",!0),x.value&&l(q)!==null&&l(I)!==null?(o(),s("div",{key:5,class:"absolute pointer-events-none transition-opacity duration-200",style:pe({left:`${l(q)}px`,top:`${l(I)}px`,transform:"translate(-50%, -50%)"})},h[2]||(h[2]=[e("div",{class:"w-2 h-2 bg-blue-500 rounded-full opacity-60"},null,-1)]),4)):M("",!0)],2),e("div",bt,[e("div",xt,[e("h3",wt,b(X.value),1),e("button",{onClick:Q,class:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-1 hover:bg-gray-100 rounded",title:l(p)?"已複製！":"複製圖片連結"},[l(p)?(o(),s("svg",$t,h[4]||(h[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(o(),s("svg",_t,h[3]||(h[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],8,kt)]),w.image.category==="photography"&&w.image.camera?(o(),s("div",Ct,[e("div",Mt,[h[5]||(h[5]=e("svg",{class:"w-4 h-4 mr-2 opacity-60",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z","clip-rule":"evenodd"})],-1)),e("span",null,b(P.value),1)]),e("div",St,[w.image.focalLength?(o(),s("div",Et,[h[6]||(h[6]=e("div",{class:"text-gray-400 mb-1 font-light"},"焦距",-1)),e("div",It,b(w.image.focalLength)+"mm",1)])):M("",!0),w.image.aperture?(o(),s("div",Tt,[h[7]||(h[7]=e("div",{class:"text-gray-400 mb-1 font-light"},"光圈",-1)),e("div",Lt,"f/"+b(w.image.aperture),1)])):M("",!0),w.image.iso?(o(),s("div",Dt,[h[8]||(h[8]=e("div",{class:"text-gray-400 mb-1 font-light"},"ISO",-1)),e("div",jt,b(w.image.iso),1)])):M("",!0),w.image.shutterSpeed?(o(),s("div",Nt,[h[9]||(h[9]=e("div",{class:"text-gray-400 mb-1 font-light"},"快門",-1)),e("div",zt,b(le.value),1)])):M("",!0)])])):(o(),s("div",Bt,[e("p",Wt,b(w.image.description),1)]))])],36))}}),At={class:"min-h-screen bg-gray-50"},Ft={class:"container mx-auto px-4 py-12"},Ot={class:"container mx-auto px-4 relative"},Yt={key:0,class:"text-center py-12"},Pt={key:1,class:"space-y-16"},Ht={class:"mb-4 border border-gray-100 rounded-lg"},Gt={class:"p-6 border-b border-gray-150"},Rt={class:"flex items-center justify-between"},Kt={class:"text-xl font-light text-gray-800 tracking-wide"},Xt=["onClick"],Qt={class:"text-sm text-gray-600 mt-2"},qt={class:"p-4"},Ut={class:"grid grid-cols-3 gap-2"},Zt=["onClick"],Jt=["src","alt"],eo={key:0,class:"text-center mt-3"},to={class:"text-xs text-gray-500"},oo={key:0,class:"space-y-8 ml-4 border-l-2 border-gray-150 pl-6 pb-6 relative"},so={key:0,class:"absolute top-full left-0 right-0 z-0 flex justify-between px-8",style:{height:"2rem"}},ao={key:0,class:"fixed inset-0 z-[9999] bg-black bg-opacity-90 backdrop-blur-sm"},no={class:"relative w-full h-full flex items-center justify-center p-4"},ro={class:"absolute top-4 left-4 right-4 z-10 flex items-center justify-between"},lo={class:"flex items-center space-x-4 bg-black bg-opacity-50 backdrop-blur-sm rounded-lg px-4 py-2"},io={class:"text-white"},co={class:"font-medium"},uo={class:"text-sm text-gray-300"},vo={class:"flex items-center space-x-2 bg-black bg-opacity-50 backdrop-blur-sm rounded-lg px-2 py-2"},mo=["disabled"],go={class:"text-white text-sm min-w-[60px] text-center"},ho=["disabled"],po=["title"],fo={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yo={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bo=["src","alt"],xo={key:1,class:"absolute inset-0 flex items-center justify-center"},wo={key:2,class:"absolute bottom-8 left-1/2 transform -translate-x-1/2"},ko={class:"relative"},_o={class:"relative"},$o=["onClick","title"],Co=["src","alt"],Mo={key:0,class:"absolute inset-0 rounded-full bg-gradient-to-r from-blue-500/20 to-purple-600/20 animate-pulse"},So={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-black bg-opacity-70 backdrop-blur-sm rounded-full border-2 border-white border-opacity-30 hover:border-opacity-60 transition-all duration-300 flex items-center justify-center group z-40"},Eo={class:"text-white text-xs font-medium"},we=140,Io=me({__name:"gallery",setup(u){const g=ge(),{mixedPhotoItems:n,expandedGroups:f,isLoading:z,digitalError:A,photographyError:E}=fe(g),{loadAllWorks:c,toggleGroupExpansion:x,refreshData:K}=g,q=Me(),I=S(!1),T=S([]),p=S(0),j=S(1),W=S(0),X=S(0),U=S(!1),P=S(!0),le=S(),ae=S(0),te=S(!1),H=De({}),Z=S(!1),ne=S(0),J=a=>f.value[a]||!1,Q=_(()=>T.value[p.value]||null),ie=_(()=>`scale(${j.value}) translate(${W.value}px, ${X.value}px)`),w=_(()=>{const a={transform:ie.value,transformOrigin:"center center"};return P.value?{...a,maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"}:{...a,maxWidth:"none",maxHeight:"none",width:"auto",height:"auto"}}),h=_(()=>j.value<5),oe=_(()=>j.value>.5),F=_(()=>p.value>0),re=_(()=>p.value<T.value.length-1),r=a=>{var D;let t=null;for(const v of n.value)if((D=v.images)!=null&&D.some($=>$.id===a.id)){t=v;break}if(t&&t.images){const v=t.images.findIndex($=>$.id===a.id);T.value=t.images,p.value=Math.max(0,v)}else T.value=[a],p.value=0;I.value=!0,document.body.style.overflow="hidden"},m=()=>{I.value=!1,document.body.style.overflow="",d()},i=()=>{F.value&&be(p.value-1)},y=()=>{re.value&&be(p.value+1)},d=()=>{j.value=1,W.value=0,X.value=0,P.value=!0},C=()=>{P.value=!P.value,P.value&&d()},k=()=>{h.value&&(j.value=Math.min(j.value*1.5,5))},N=()=>{if(oe.value){const a=Math.max(j.value/1.5,.5);j.value=a,a<=1&&(W.value=0,X.value=0)}};function L(a,t){const D=T.value.length;if(D===1)return{x:0,y:-we};const v=(a-t+D)%D,$=180/Math.max(1,D-1),R=(0+v*$)*Math.PI/180,V=Math.cos(R)*we,O=-Math.sin(R)*we;return{x:V,y:O}}function ee(a,t,D){return a+(t-a)*D}function ye(a){return 1-(1-a)*(1-a)}function Se(a,t){const D=T.value.length;if(D<=1)return;Z.value=!0,ne.value=performance.now();const v={},$={};for(let V=0;V<D;V++)v[V]=L(V,a),$[V]=L(V,t),H[V]={...v[V]};const G=400,R=V=>{const O=Math.min((V-ne.value)/G,1),de=ye(O);for(let Y=0;Y<D;Y++)H[Y].x=ee(v[Y].x,$[Y].x,de),H[Y].y=ee(v[Y].y,$[Y].y,de);O<1?requestAnimationFrame(R):Z.value=!1};requestAnimationFrame(R)}function he(a){T.value.forEach((t,D)=>{H[D]=L(D,a)})}const be=a=>{if(a===p.value||Z.value)return;const t=p.value;ae.value=t,te.value=!0,Se(t,a),setTimeout(()=>{p.value=a,te.value=!1,d(),he(a)},400)},Ee=a=>{if(j.value<=1)return;U.value=!0;const t=a.clientX-W.value,D=a.clientY-X.value,v=G=>{U.value&&(W.value=G.clientX-t,X.value=G.clientY-D)},$=()=>{U.value=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",$)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",$)},ke=a=>{I.value&&(a.preventDefault(),a.deltaY<0?k():N())},_e=a=>{if(I.value){switch(a.key){case"Escape":m();break;case"ArrowLeft":i();break;case"ArrowRight":y();break;case"+":case"=":k();break;case"-":case"_":N();break;case"0":d();break;case"1":C();break}if(a.ctrlKey)switch(a.key){case"+":case"=":a.preventDefault(),k();break;case"-":case"_":a.preventDefault(),N();break}}};return ve(p,a=>{Z.value||he(a)}),ve(T,()=>he(p.value)),ve([A,E],([a,t])=>{a&&q.error("載入數位作品失敗","請檢查網路連線或稍後再試"),t&&q.error("載入攝影作品失敗","請檢查網路連線或稍後再試")}),je(async()=>{try{if(await q.promise(c(),{loading:"載入作品中...",success:"作品載入完成！",error:"載入作品失敗"}),n.value.length>0){const a=n.value[0];a.eventName?x(a.eventName):x("no-event")}}catch(a){console.error("Failed to load works:",a)}he(p.value),document.addEventListener("keydown",_e),document.addEventListener("wheel",ke,{passive:!1})}),Ne(()=>{document.removeEventListener("keydown",_e),document.removeEventListener("wheel",ke),document.body.style.overflow=""}),Oe({title:"Works - 作品集",meta:[{name:"description",content:"數位藝術與攝影作品集"}]}),(a,t)=>{var D;return o(),s("div",At,[e("div",Ft,[t[2]||(t[2]=e("h1",{class:"text-4xl font-light text-gray-800 mb-4 tracking-wide"},"Works",-1)),t[3]||(t[3]=e("p",{class:"text-gray-600 font-light mb-8"},"作品集 - Digital Art & Photography",-1)),xe(Ue),xe(tt)]),e("div",Ot,[t[7]||(t[7]=e("div",{class:"absolute left-8 top-0 bottom-0 w-px bg-gray-300 hidden md:block"},null,-1)),l(z)?(o(),s("div",Yt,t[4]||(t[4]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-800"},null,-1),e("p",{class:"mt-4 text-gray-600"},"載入中...",-1)]))):(o(),s("div",Pt,[(o(!0),s(ce,null,ue(l(n),(v,$)=>(o(),ze(ct,{key:v.key,index:$,"time-label":v.timeRange||"","event-info":v.eventInfo,"event-key":v.eventName||"no-event","show-event-control":!!v.eventName,"show-event-info":!!v.eventName},{default:Be(()=>{var G,R,V;return[e("div",Ht,[e("div",Gt,[e("div",Rt,[e("h3",Kt,b(v.eventName||"其他作品"),1),e("button",{onClick:O=>l(x)(v.eventName||"no-event"),class:"flex items-center gap-2 px-3 py-1 text-sm text-gray-600 hover:text-gray-800 border border-gray-200 rounded transition-colors duration-200"},[e("span",null,b(J(v.eventName||"no-event")?"收起":"展開"),1),(o(),s("svg",{class:B(["w-4 h-4 transform transition-transform duration-200",J(v.eventName||"no-event")?"rotate-180":""]),fill:"currentColor",viewBox:"0 0 20 20"},t[5]||(t[5]=[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))],8,Xt)]),e("p",Qt,b(((G=v.images)==null?void 0:G.length)||0)+" 張作品",1)]),e("div",qt,[e("div",Ut,[(o(!0),s(ce,null,ue((v.images||[]).slice(0,3),(O,de)=>(o(),s("div",{key:O.filename,onClick:Y=>r(O),class:"aspect-square rounded overflow-hidden border border-gray-100 cursor-pointer"},[e("img",{src:`/images/${O.filename}`,alt:O.title,class:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"},null,8,Jt)],8,Zt))),128))]),(((R=v.images)==null?void 0:R.length)||0)>3?(o(),s("div",eo,[e("span",to,"還有 "+b((((V=v.images)==null?void 0:V.length)||0)-3)+" 張作品",1)])):M("",!0)]),J(v.eventName||"no-event")?(o(),s("div",oo,[(o(!0),s(ce,null,ue(v.images||[],(O,de)=>{var Y;return o(),s("div",{key:O.filename,class:"relative"},[de<(((Y=v.images)==null?void 0:Y.length)||0)-1?(o(),s("div",so,t[6]||(t[6]=[e("div",{class:"w-0.5 h-full bg-gray-400 opacity-70"},null,-1),e("div",{class:"w-0.5 h-full bg-gray-400 opacity-70"},null,-1)]))):M("",!0),xe(Vt,{image:O,onOpenViewer:r},null,8,["image"])])}),128))])):M("",!0)])]}),_:2},1032,["index","time-label","event-info","event-key","show-event-control","show-event-info"]))),128))]))]),t[19]||(t[19]=e("div",{class:"container mx-auto px-4 py-16 text-center"},[e("div",{class:"text-2xl font-light text-gray-400 italic"},"friday vibes"),e("div",{class:"text-sm text-gray-500 mt-2"},"thank god it's friday!")],-1)),l(I)?(o(),s("div",ao,[e("div",{onClick:m,class:"absolute inset-0"}),e("div",no,[e("div",ro,[e("div",lo,[e("div",io,[e("h3",co,b(((D=Q.value)==null?void 0:D.title)||"未命名"),1),e("p",uo,b(l(p)+1)+" / "+b(l(T).length),1)])]),e("div",vo,[e("button",{onClick:N,disabled:!oe.value,class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"縮小 (Ctrl + -)"},t[8]||(t[8]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})],-1)]),8,mo),e("span",go,b(Math.round(l(j)*100))+"%",1),e("button",{onClick:k,disabled:!h.value,class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"放大 (Ctrl + +)"},t[9]||(t[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})],-1)]),8,ho),e("button",{onClick:C,class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:l(P)?"顯示原始大小":"適應螢幕"},[l(P)?(o(),s("svg",fo,t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"},null,-1)]))):(o(),s("svg",yo,t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"},null,-1)])))],8,po),e("button",{onClick:d,class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"重置縮放 (0)"},t[12]||(t[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])),e("button",{onClick:m,class:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"關閉 (Esc)"},t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])]),e("div",{class:"relative w-full h-full flex items-center justify-center overflow-hidden",onClick:t[1]||(t[1]=$e(()=>{},["stop"]))},[Q.value?(o(),s("img",{key:0,ref_key:"imageElement",ref:le,src:`/images/${Q.value.filename}`,alt:Q.value.title,class:B(["transition-transform duration-200 ease-out select-none",l(j)>1?"cursor-grab active:cursor-grabbing":"cursor-default"]),style:pe(w.value),draggable:"false",onClick:t[0]||(t[0]=$e(()=>{},["stop"])),onMousedown:Ee},null,46,bo)):M("",!0),Q.value?M("",!0):(o(),s("div",xo,t[14]||(t[14]=[e("div",{class:"text-white text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e("p",null,"載入中...")],-1)])))]),l(T).length>1&&F.value?(o(),s("button",{key:0,onClick:i,class:"absolute left-4 top-1/2 transform -translate-y-1/2 p-3 bg-black bg-opacity-50 backdrop-blur-sm text-white rounded-full hover:bg-opacity-70 transition-colors",title:"上一張 (←)"},t[15]||(t[15]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):M("",!0),l(T).length>1&&re.value?(o(),s("button",{key:1,onClick:y,class:"absolute right-4 top-1/2 transform -translate-y-1/2 p-3 bg-black bg-opacity-50 backdrop-blur-sm text-white rounded-full hover:bg-opacity-70 transition-colors",title:"下一張 (→)"},t[16]||(t[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):M("",!0),l(T).length>1?(o(),s("div",wo,[e("div",ko,[e("div",_o,[(o(!0),s(ce,null,ue(l(T),(v,$)=>{var G,R;return o(),s("button",{key:v.id,onClick:V=>be($),style:pe({position:"absolute",left:"50%",top:"50%",width:"48px",height:"48px",transform:`translate(-50%, -50%) translate(${((G=H[$])==null?void 0:G.x)||0}px, ${((R=H[$])==null?void 0:R.y)||0}px)`,opacity:$===l(p)?1:l(te)&&$===l(ae)?0:.6,zIndex:$===l(p)?30:20,transition:"opacity 0.4s ease-out, transform 0.4s ease-out"}),class:B(["rounded-full border-2 overflow-hidden bg-gray-800 bg-opacity-80 hover:scale-110 transition-all duration-300",$===l(p)?"border-white shadow-2xl shadow-blue-500/60 radial-nav-active":"border-gray-600 hover:border-white"]),title:`${v.title} (${$+1}/${l(T).length})`},[e("img",{src:`/images/${v.filename}`,alt:v.title,class:"w-full h-full object-cover"},null,8,Co),$===l(p)?(o(),s("div",Mo)):M("",!0)],14,$o)}),128))]),e("button",So,[e("div",Eo,b(l(p)+1)+"/"+b(l(T).length),1),t[17]||(t[17]=e("div",{class:"absolute inset-0 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 opacity-0 group-hover:opacity-20 transition-opacity duration-300"},null,-1))]),t[18]||(t[18]=e("div",{class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 opacity-10 scale-150 animate-pulse pointer-events-none w-20 h-20"},null,-1))])])):M("",!0)])])):M("",!0)])}}}),No=Ye(Io,[["__scopeId","data-v-b5ddae41"]]);export{No as default};
